---
tags:
  - pca
---
基因a和基因b在数据和趋势上相似，那么我们认为它对于细胞的生物学作用是类似的，从把这种”基因“作为一个集合，也就是主成分，那么在类似于”合并数据“的过程中达到了降维，我们称这个过程叫做pca降维
更形象地说，想象你有一大批乐器（基因）在演奏，有些乐器经常一起响（基因共表达），PCA 就是找出“乐团的主要旋律”（主成分），用旋律代替单个乐器声音，让你更快听懂音乐的主题

# ==scRNA应用==
主要是在umap和tsne分析前进行
## workflow：
RUNPCA>umap>tsne
RUNPCA(data),这会默认提取前五十个重要的主成分
但是在此之前，一般要绘制==滚石==图
```r
pdf(file = "6.pdf",width = 7,height = 6)
ElbowPlot(Seurat_data1,ndims = 50)
dev.off()
```
![滚石图]("pdf(file = "6.pdf",width = 7,height = 6)
![滚石图](C:\Users\kantt\OneDrive\Pictures\Screenshots\滚石.png)
如图可见，我们一般要找到第一个斜率接近0的点所在位置，这里我们会选择35左右的数值作为后续分析的dim
附:滚石图典型趋势象征意义

| 曲线          | 意义                       |
| ----------- | ------------------------ |
| 陡降后迅速变平     | 数据结构清晰，前几个PC已捕获主要信息      |
| 平缓下降，肘部不明显  | 数据噪声多、聚类结构弱              |
| 曲线平滑、没有明显肘部 | 不建议强行聚类，可考虑使用更多PC或不同降维方式 |

## ==UMAP与TSNE==
如前文所述，二者都涉及到dim概念，这是决定细胞亚群聚合程度和准确度的重要概念
PCA提取的是“哪些生物学过程主导了细胞间的差异”，UMAP/t-SNE 是把这些差异“画成地图”
比如说PCA分析后，我们知道面对细胞周期维度上得分是 +2.3，在炎症维度上得分是 -1.7，那么umap和tsne会把这些得分相似的细胞集合在一起，如果高度集中并且明显分族，就代表我们找到了细胞间的表达差异

## 附：Harmony方法（批次效应校正）
在低维空间中**校正不同样本/批次带来的非生物学差异**，比如不同病人、不同平台、不同处理方式之间的影响
使用情况比如说，我们在处理同一个数据，geo往往会用不同机体的不同样本来做重复的上游数据，这个过程注定会产生批次效应，往往需要消除批次效应，常常用在**替代/接在 PCA 后**，用于更公平的聚类与可视化